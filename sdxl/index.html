<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SDXL</title>
</head>
<body >
    <label for="promptInput">Prompt:</label>
    <input type="text" id="promptInput" placeholder="Prompt">
    <br><br>
    <label for="negativePromptInput">Negative Prompt:</label>
    <input type="text" id="negativePromptInput" placeholder="Negative prompt">
    <br><br>
    <label for="authTokenInput">Deepinfra API token:</label>
    <input type="password" id="authTokenInput" placeholder="Token de autenticação">
    <br><br>
    <label for="heightInput">Height:</label>
    <input type="number" id="heightInput" value="512" placeholder="height">
    <br><br>
    <label for="widthInput">Width:</label>
    <input type="number" id="widthInput" value="512" placeholder="width">
    <br><br>
    <label for="numInferenceStepsInput">Number of inference steps:</label>
    <input type="number" id="numInferenceStepsInput" value="25" placeholder="Number of inference steps">
    <br><br>
    <label for="guidanceScaleInput">Guidance Scale:</label>
    <input type="number" id="guidanceScaleInput" value="7.5" placeholder="guidanceScale">
    <br><br>
    <label for="seedInput">Seed:</label>
    <input type="number" id="seedInput" value="0" placeholder="Seed">
    <button id="generateButton">Generate image</button>
    <br><br>
    <img id="generatedImage" width="512" height="512">
</body>
<script type="module">

document.getElementById('generateButton').addEventListener('click', generateImage);
async function generateImage(){
  const authToken = document.getElementById('authTokenInput').value;
  const prompt = document.getElementById('promptInput').value;
  const negativePrompt = document.getElementById('negativePromptInput').value;
  const height = document.getElementById('heightInput').value;
  const width = document.getElementById('widthInput').value;
  const guidanceScale = document.getElementById('guidanceScaleInput').value;
  const numInferenceSteps = document.getElementById('numInferenceStepsInput').value;
  const seed = document.getElementById('seedInput').value;

  const formData = new FormData();
  formData.append('prompt', prompt);
  formData.append('negative_prompt', negativePrompt);
  formData.append('height', height);
  formData.append('width', width);
  formData.append('guidance_scale', guidanceScale);
  formData.append('num_inference_steps', numInferenceSteps);
  if (seed > 0){
    formData.append('seed', seed);
  }
  
  const requestOptions = {
    method: 'POST',
    headers: {
      'Authorization': `bearer ${authToken}`,
    },
    body: formData
  };
  
  try {
    const response = await fetch('https://api.deepinfra.com/v1/inference/Lykon/DreamShaper', requestOptions);
    const data = await response.json();
    
    if (data.images && data.images.length > 0) {
      const imageElement = document.getElementById('generatedImage');
      imageElement.src = data.images[0];
    }
  } catch (error) {
    console.error('Houve um erro ao fazer a requisição:', error);
  }
}
</script>
</html>
